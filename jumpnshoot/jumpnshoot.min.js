(function(f){function ba(){var f=document.createElement("script");f.src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js";f.type="text/javascript";f.onload=function(){console.log("JumpNShoot: loaded jQuery",jQuery.fn.jquery);A()};document.getElementsByTagName("head")[0].appendChild(f)}function A(){function z(a,c){function b(){this.height=this.$element.height();this.width=this.$element.width();this.top=this.$element.offset().top;this.left=this.$element.offset().left;this.bottom=this.$element.offset().top+
this.$element.height();this.right=this.$element.offset().left+this.$element.width()}c||(c="");this.$element=a;b=b.bind(this);b();"bullet"!=c&&"player"!=c&&(this.updatePositionCache=b);"player"==c?(this.oneSidePadding=(a.innerWidth()-a.width())/2,this.innerWidth=a.innerWidth(),this.background_position_y=-200,this.background_position_x=0,this.arm={background_position_x:0}):"bullet"==c?(this.xVelocity=this.yVelocity=0,this.shot=!1):"platform"==c?this.active_platform=!1:"target"==c&&(this.destroyed=this.destroy=
this.hit=!1,this.hitAnimation=this.hitCounter=0)}function A(){b.bottom=b.top+b.height;for(var a=0;a<g.length;a++)if(R(g[a],1.5*f.MAX_WALK_SPEED,f.MAX_FALL_SPEED))if(b.bottom>=g[a].top&&b.bottom<g[a].top+f.MAX_FALL_SPEED&&b.left+b.innerWidth-b.oneSidePadding>=g[a].left&&b.left+b.oneSidePadding<=g[a].right&&m<=w){x=!0;0==g[a].active_platform&&(g[a].active_platform=!0,n[a].classList.add("active_platform"));b.bottom>g[a].top&&(b.top=g[a].top-b.height);break}else if(b.bottom>=document.documentElement.clientHeight+
window.pageYOffset){x=!0;b.bottom>document.documentElement.clientHeight+window.pageYOffset&&(b.top=document.documentElement.clientHeight+window.pageYOffset-b.height);break}else if(0>=b.top+b.height){x=!1;b.top=f.MAX_FALL_SPEED-b.height;break}else x=!1,1==g[a].active_platform&&(g[a].active_platform=!1,n[a].classList.remove("active_platform"));x?w=0:(b.background_position_y=0,w<f.MAX_FALL_SPEED&&(w+=1));0>b.top&&(B=m=0);m>w&&(b.background_position_y=-100);x&&(m=0,B=2,b.background_position_y=-200);0<
m&&m--;S&&0<B&&0==Math.trunc(m)?(E||(m=f.JUMP_VELOCITY,B--),E=!0):E=!1;C?D<.5*F?D++:(b.top+=f.MAX_FALL_SPEED,falling=!0,D=0):D=0;G?(1>p&&(p=1,d[Math.trunc(y)].shot?p=0:(d[Math.trunc(y)].shot=!0,r[Math.trunc(y)].classList.add("shot"),y=y<r.length-1?y+1:0)),p+=.2,b.arm.background_position_x=-100*Math.trunc(p),3<p&&(p=0)):(p=0,b.arm.background_position_x=0);window.scrollTo(b.left-H.width()/2+b.innerWidth/2,b.top-document.documentElement.clientHeight/3);T=t*Math.atan2(I-k.offset().top-k.height()/2+26,
J-k.offset().left-k.innerWidth()/2)*180/Math.PI+(0<t?0:180);u=Math.atan2(I-k.offset().top-k.height()/2+26,J-k.offset().left-k.innerWidth()/2);K?t=1:L&&(t=-1);L||K?(q=C?q+.09:M?q+.4:q+.2,b.background_position_x=-100*Math.trunc(q),8<q&&(q=1),v<f.MAX_WALK_SPEED&&(v+=1)):(q=0,b.background_position_x=0,0<v?v-=.5:0>v&&(v=0));a=1;C?a=.2:M&&(a=1.5);b.top=b.top+w-m;b.left+=v*a*t;0>b.left+b.oneSidePadding&&(b.left=-1*b.oneSidePadding);k.css({top:b.top+"px",left:b.left+"px","background-position-y":b.background_position_y+
"px","background-position-x":b.background_position_x+"px",transform:"scaleX("+t+")"});N.css({transform:"rotate("+T+"deg)","background-position-x":b.arm.background_position_x+"px"});requestAnimationFrame(A)}function U(){1==t?(O=b.left+43+30*Math.cos(u+.6),P=b.top+22+30*Math.sin(u+.6)):(O=b.left+53+30*Math.cos(u-.6),P=b.top+22+30*Math.sin(u-.6));for(var a=0;a<d.length;a++){d[a].shot?(0==d[a].yVelocity&&0==d[a].xVelocity&&(d[a].top=P,d[a].left=O,d[a].xVelocity=f.BULLET_SPEED*Math.cos(u),d[a].yVelocity=
f.BULLET_SPEED*Math.sin(u)),d[a].top+=d[a].yVelocity,d[a].left+=d[a].xVelocity,d[a].shot&&!R(d[a],d[a].xVelocity,d[a].yVelocity)&&(d[a].shot&&(d[a].shot=!1,r[a].classList.remove("shot")),d[a].yVelocity=0,d[a].xVelocity=0)):(d[a].top=-5,d[a].left=-5);for(var c=0;c<e.length;c++)1!=e[c].destroyed&&(1==e[c].destroy&&(e[c].bottom>=document.documentElement.clientHeight+window.pageYOffset||e[c].left>=document.documentElement.clientWidth+window.scrollLeft)?(e[c].destroy=!1,e[c].destroyed=!0,l[c].classList.remove("destroy"),
l[c].classList.add("destroyed")):0==e[c].destroy&&0==e[c].destroyed&&1==d[a].shot&&d[a].top>=e[c].top&&d[a].top+d[a].height<=e[c].bottom&&d[a].left>=e[c].left&&d[a].left+d[a].width<=e[c].left+e[c].width?(0==e[c].hit&&(e[c].hit=!0,l[c].classList.add("hit")),e[c].hitAnimation=1.4*F,d[a].shot=!1,r[a].classList.remove("shot"),d[a].yVelocity=0,d[a].xVelocity=0,0==e[c].hitcounter?e[c].hitCounter=1:5>e[c].hitCounter?e[c].hitCounter+=1:(e[c].hitCounter=0,e[c].hit=!1,e[c].destroy=!0,l[c].classList.remove("hit"),
l[c].classList.add("destroy"))):0<e[c].hitAnimation?--e[c].hitAnimation:(e[c].hit=!1,l[c].classList.remove("hit"),e[c].hitAnimation=0));r.eq(a).css({top:d[a].top+"px",left:d[a].left+"px"})}requestAnimationFrame(U)}function R(a,c,b){c||(c=0);b||(b=0);if(!a instanceof z)throw Error("isOnScreen requires instanceof cachedShape");return a.top<window.pageYOffset+document.documentElement.clientHeight-b&&a.top+a.height>window.pageYOffset+b&&a.left<window.pageXOffset+document.documentElement.clientWidth-c&&
a.left+a.width>window.pageXOffset+c?!0:!1}function V(a){F=1E3/(a-W);W=a;requestAnimationFrame(V)}function X(a){return function(c){var b=!0;"32"==c.keyCode||"87"==c.keyCode||"38"==c.keyCode||"ArrowUp"==c.key?S=a:"65"==c.keyCode||"37"==c.keycode||"ArrowLeft"==c.key?L=a:"68"==c.keyCode||"39"==c.keycode||"ArrowRight"==c.key?K=a:"83"==c.keyCode||"40"==c.keycode||"ArrowDown"==c.key?C=a:"16"==c.keyCode?M=a:b=!1;b&&c.preventDefault()}}function Q(a){return function(c){1==c.which&&(c.target.classList.contains("jumpnshoot-click-allowed")?
G=!1:(c.preventDefault(),void 0!==a&&(G=a)))}}f.MAX_FALL_SPEED=15;f.MAX_WALK_SPEED=10;f.JUMP_VELOCITY=31;f.BULLET_SPEED=15;var H=$(window),Y=$(document.body),g=[],e=[],d=[],w=0,v=0,t=1,x=!1,m=0,E=!1,B=2,D=0,u=0,T=0,y=0,O=0,P=0,F=0,L=!1,K=!1,M=!1,S=!1,C=!1,G=!1,J,I,q=0,p=0,k=$("<div>",{id:"player",html:""}),N=$("<div>",{id:"arm",html:""}),Z=$("<span>",{"class":"bullet",html:""});k.css({width:"50px",height:"100px",padding:"0",margin:"0","padding-left":"25px","padding-right":"25px",position:"absolute",
top:"10px",left:"5px","background-color":"transparent","background-image":"url(https://saberpeep.github.io/web-demos/jumpnshoot/jumpnshoot-sheet.png)","background-repeat":"no-repeat","background-position-x":"0px","background-position-y":"-200px",display:"block","box-sizing":"content-box","z-index":"999"});N.css({width:"100px",height:"75px",padding:"0",margin:"0",position:"absolute",top:"0px",left:"0px","background-color":"transparent","background-image":"url(https://saberpeep.github.io/web-demos/jumpnshoot/jumpnshoot-arms-sheet.png)",
"background-repeat":"no-repeat","background-position-x":"0px","transform-origin":"45px 24px"});Z.css({width:"4px",height:"4px",padding:"0",margin:"0",position:"absolute",top:"0px",left:"0px","background-color":"#fd3900","transform-origin":"20px -15px","border-radius":"2px",visibility:"hidden","z-index":"999"});k.append(N);Y.append(k);for(var h=0;10>h;h++)Y.append(Z.clone());var r=$(".bullet");var n=$("div, article, container, aside, header, footer, iframe").not(".bullet, #player, #arm").not(function(){return"fixed"==
$(this).css("position")?!0:!1});var l=$("span, a, img, h1, h2, h3, h4, h5, li, th, td, button, input").not(".bullet, #player, #arm").not(function(){return"fixed"==$(this).css("position")?!0:!1}).not(function(){return 0<$(this).find("span, a, img, h1, h2, h3, h4, h5, li, th, td, button, input").length?!0:!1});1500<n.length&&(console.warn("JumpNShoot: platform array length limited to ",1500," (",n.length,")"),n.slice(1500).css("opacity","0.7"),n=n.slice(0,1500));1500<l.length&&(console.warn("JumpNShoot: target array length limited to ",
1500," (",l.length,")"),l=l.slice(0,1500));var b=new z(k,"player");for(h=0;h<n.length;h++)g.push(new z(n.eq(h),"platform"));for(h=0;h<r.length;h++)d.push(new z(r.eq(h),"bullet"));for(h=0;h<l.length;h++)e.push(new z(l.eq(h),"target"));l.filter(function(){return"inline"==$(this).css("display")?!0:!1}).addClass("inlineFix");$("<style>").prop("type","text/css").html("@keyframes hit {                        0%   {transform: rotate(0deg)}                        45%  {transform: rotate(5deg)}                        85% {transform: rotate(-5deg)}                        100% {transform: rotate(0deg)}                    }                   @keyframes destroy {                        0%   {transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); visibility:visible;}                        30%   {transform: translateY(-200px) translateX(50px) rotate(520deg) scale(0.5); visibility:visible;}                        99% {transform: translateY(300px) translateX(100px) rotate(2500deg) scale(0); visibility:hidden;}                        100% {transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); visibility:hidden;}                    }                  .active_platform {                        transition: border 1s;                        border-top: 2px solid black !important;                    }                   .shot {                        visibility: visible !important;                    }                   .hit {                        transform-origin: center center;                        animation-name: hit;                        animation-duration: 0.3s;                        animation-iteration-count: infinite;                        animation-timing-function: cubic-bezier(.61,-0.16,.52,1.06);                   }                   .destroy {                        transform-origin: center center;                        animation-name: destroy;                        animation-duration: 1s;                        animation-timing-function: linear;                        animation-fill-mode: forwards;                   }                   .destroyed {                        visibility: hidden !important;                   }                   .inlineFix.hit, .inlineFix.destroy, .inlineFix.destroyed {                        display:inline-block;                   }").appendTo("head");
$("title").text("JumpNShoot in "+$("title").text());requestAnimationFrame(A);requestAnimationFrame(U);var W=performance.now();requestAnimationFrame(V);window.addEventListener("mousemove",function(a){J=a.pageX;I=a.pageY});H.keydown(X(!0));H.keyup(X(!1));window.addEventListener("mousedown",Q(!0));window.addEventListener("mouseup",Q(!1));window.addEventListener("click",Q());var aa;window.addEventListener("resize",function(a){clearTimeout(aa);aa=setTimeout(function(){for(var a=performance.now(),b=0;b<
g.length;b++)g[b].updatePositionCache();b=performance.now();console.log("JumpNShoot: platform cache updated ("+Math.trunc(b-a)+"ms)");a=b;for(b=0;b<e.length;b++)e[b].updatePositionCache();b=performance.now();console.log("JumpNShoot: target cache updated ("+Math.trunc(b-a)+"ms)")},500)},!0)}f.start=function(){f.ALREADY_RUNNING?console.warn("JumpNShoot: can't start, instance already running!"):(f.ALREADY_RUNNING=!0,Math.trunc=Math.trunc||function(f){return isNaN(f)?NaN:0<f?Math.floor(f):Math.ceil(f)},
"undefined"===typeof jQuery||"3.2.1">jQuery.fn.jquery?(console.log("JumpNShoot: jQuery 3.2.1 or greater not present, loading jQ"),ba()):A())}})(window.JumpNShoot=window.JumpNShoot||{});